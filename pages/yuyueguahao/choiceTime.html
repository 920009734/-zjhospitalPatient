<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
        <meta name="format-detection" content="telephone=no">
        <link rel="stylesheet" href="../../css/frozen.css">
        <link rel="stylesheet" href="../../css/style.css" />
        <script src="../../js/jquery-1.8.3.min.js"></script>
        <script src="../../js/Utils.js"></script>
		<title>选择时间</title>
		<style type="text/css">
			html,body{font-family: "微软雅黑";height: 100%;width: 100%;}
			.doc_detai{display: block;width: 100%;height: 50px;line-height:50px;border-bottom: 1px solid #EEEAEB;background-color: #FFFFFF;}
			.date_pers{margin-left: 10px;}
			.date_type{font-size: 13px;margin-left: 15px;}
			.date_time{display: block;float:right;font-size:13px;margin-right: 10px;}
			.date_detail{display: block;width:100% ;height: 60px;border-bottom: 1px solid #EEEAEB;}
			.ck_time{display: block;float: left;margin-top:15px;margin-left:10px;width: 16%;height: 30px;text-align:center;line-height: 30px; border: 1px solid #199ED8;border-radius: 2px;color: #199ED8;font-size: 15px;}
			.detail_time{display: block;float: left;width: 100%;height: 30px;background-color: #F7F7F7;line-height: 30px;font-size: 15px;color: #4CB6AC;}
			.detail_time>p{margin-left: 10px;}
			.detail_dateTime{display: block;float: left;width: 100%;min-height: 50px;max-height: 200px;background-color: #FFFFFF;}
			.ck_dateTime{display: block;float: left;width: 100%;height: 50px;line-height: 50px;border-bottom: 1px solid #E4E4E4;font-size: 15px;}
			.ck_dateTime:last-child{border: none;}
			.slot_item{display: block;float: left;width: 94%;margin-left: 3%;height:50px;line-height: 50px;}
			.slot_item>span{display: block;float: left;}
			.time_slot{width: 54%;}
			.yuhao, .ghmoney{width: 22%;height: 30px;line-height: 30px;font-size: 13px;text-align: center;margin-top: 10px;margin-left: 1%;color: #FFFFFF;border-radius: 3px;}
			.yuhao{background-color: #3B92A6;}
			.ghmoney{background-color: #D84C29;}
			.notData{color: #999999;}
		</style>
		<script type="text/javascript">
        	$(function(){
        		function GetRequest() {
       			  var url = decodeURI(location.search); //获取url中"?"符后的字串
       			   var theRequest = new Object();
       			   if (url.indexOf("?") != -1) {
       			      var str = url.substr(1);
       			      strs = str.split("&");
       			      for(var i = 0; i < strs.length; i ++) {
       			         theRequest[strs[i].split("=")[0]]=(strs[i].split("=")[1]);
       			      }
       			   }
       			   return theRequest;
       			}
        		var Request = new Object();
        		Request = GetRequest();
        		$("#deptCode").val(Request["deptCode"]);
        		$("#doctorCode").val(Request["doctorCode"]);
        		$("#deptName").text(Request["deptName"]);
        		$("#dateTime").text(Request["dateTime"]);
        		
        		var params={};
        		params.deptCode = Request["deptCode"];
        		params.doctorCode = Request["doctorCode"];
        		params.dateTime = Request["dateTime"];
        		
        		$.post(Utils.getRoot()+"/registerApp/selTime",params,function(data){
					if (data.success) {
						var doctorInfo = new Array();
						doctorInfo= data.data;
						$("#doctorName").text(doctorInfo[0].doctorName);
						for (var i = 1; i < doctorInfo.length; i++) {
							if (doctorInfo[i].timeFlag==1) {//区分时段
								if (doctorInfo[i].hasDetailTime==1) {//判断是否有分时
									//把挂号费转为元，原本是分
									var regFee = parseInt(doctorInfo[i].regFee)/100;
									$("#swdateTime").append(
										"<div class='ck_dateTime' onclick='xzTime(this,"+octorInfo[i].timeFlag+")'>"+
											"<span>"+doctorInfo[i].beginTime+" - "+doctorInfo[i].endTime+"</span>"+
											"<span>"+doctorInfo[i].leftNum+"</span>"+
											"<span>"+regFee+"</span>"+
										"</div>"
									);
								}else{
									$("#swdateTime").append(
										"<div class='ck_dateTime'> 暂无时间</div>"
									);
								} 
							} else if (doctorInfo[i].timeFlag==2){
								if (doctorInfo[i].hasDetailTime==1) {//判断是否有分时
									$("#xwdateTime").append(
										"<div class='ck_dateTime' onclick='xzTime(this,"+octorInfo[i].timeFlag+")'> "+doctorInfo[i].beginTime+" - "+doctorInfo[i].endTime+" </div>"
									);
								}else{
									$("#xwdateTime").append(
										"<div class='ck_dateTime'> 暂无时间</div>"
									);
								}
							}else{
								if (doctorInfo[i].hasDetailTime==1) {//判断是否有分时
									$("#wsdateTime").append(
										"<div class='ck_dateTime' onclick='xzTime(this,"+octorInfo[i].timeFlag+")'> "+doctorInfo[i].beginTime+" - "+doctorInfo[i].endTime+" </div>"
									);
								} else{
									$("#wsdateTime").append(
										"<div class='ck_dateTime'> 暂无时间</div>"
									);
								}
						}
					}
				});
        		function xzTime(data,timeFlag){
        			var doctorCode = $(data).children("input[name='doctorCode']").val();
        			var deptCode = $("#deptCode").val();
        			var dateTime = new Date();
        			window.location.href="../yuyueguahao/comfirmMsg.html"
        		}
        	})
        </script>
	</head>
	<body ontouchstart>
		<header class="ui-header ui-header-positive">
			<i class="ui-icon ui-icon-return" onclick="history.back()"></i>
			<h4 style="margin-left: 25px;">预约时间</h4>
		</header>
		<section class="ui-container"> 
			<section id="list">
				<div class="doc_detai">
					<input type="hidden" val="" id="doctorCode">
					<span class="date_pers" id="doctorName"></span>
					<input type="hidden" val="" id="deptCode">
					<span class="date_type" id="deptName"></span>
					<span class="date_time" id="dateTime"></span>
				</div>
				
				<div>
					<div class="time_item">
						<div class="detail_time"><p>上午</p></div>
						<div class="detail_dateTime">
							<div class="ck_dateTime">
								<div class="slot_item">
									<span class="time_slot">09:00~10:00</span>
									<span class="yuhao">余号：8</span>
									<span class="ghmoney">￥ 30:00</span>
								</div>
							</div>
							<div class="ck_dateTime">
								<div class="slot_item">
									<span class="time_slot">10:00~11:00</span>
									<span class="yuhao">余号：5</span>
									<span class="ghmoney">￥ 30:00</span>
								</div>
							</div>
							<div class="ck_dateTime">
								<div class="slot_item">
									<span class="time_slot">11:00~12:00</span>
									<span class="yuhao">余号：3</span>
									<span class="ghmoney">￥ 30:00</span>
								</div>
							</div>
						</div>
					</div>
					<div class="time_item">
						<div class="detail_time"><p>下午</p></div>
						<div class="detail_dateTime">
							<div class="ck_dateTime">
								<div class="slot_item">
									<span class="time_slot">09:00~10:00</span>
									<span class="yuhao">余号：8</span>
									<span class="ghmoney">￥ 30:00</span>
								</div>
							</div>
							<div class="ck_dateTime">
								<div class="slot_item">
									<span class="time_slot">10:00~11:00</span>
									<span class="yuhao">余号：5</span>
									<span class="ghmoney">￥ 30:00</span>
								</div>
							</div>
							<div class="ck_dateTime">
								<div class="slot_item">
									<span class="time_slot">11:00~12:00</span>
									<span class="yuhao">余号：3</span>
									<span class="ghmoney">￥ 30:00</span>
								</div>
							</div>
						</div>
					</div>
					<div class="time_item">
						<div class="detail_time"><p>晚上</p></div>
						<div class="detail_dateTime">
							<div class="ck_dateTime">
								<div class="slot_item">
									<p class="notData">暂无数据</p>
								</div>
							</div>
						</div>
					</div>
				</div>
				
				<!--<div class='time_item'>
					<div class='detail_time'><p>上午</p></div>
					<div class='detail_dateTime' id="swdateTime">
					</div>
				</div>
				<div class='time_item'>
					<div class='detail_time'><p>下午</p></div>
					<div class='detail_dateTime' id="xwdateTime">
					</div>
				</div>
				<div class='time_item'>
					<div class='detail_time'><p>晚上</p></div>
					<div class='detail_dateTime' id="wsdateTime">
					</div>
				</div>-->
			</section>
		</section>
	</body>
</html>
